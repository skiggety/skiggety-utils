#!/usr/bin/env bash

# This script reminds you to do one email iteration.

. $SKIGGETY_UTILS_DIR/lib/skiggety-utils.bash || exit 1

WITH_REWARD_ARG=''
while [[ "$1" == -* ]]; do
    if [ "$1" == "--with-reward" ]; then
        WITH_REWARD_ARG="$1"
        shift
    fi
done

# EASY TODO^24: should firstlife/bin/ be in the path before skiggety_utils so you can override firstlife code?

# EASY TODO^24: inner custom script, at least call it instead if it exists in firstlife/bin..
# EASY TODO^44: run only once to completion per day
# EASY TODO^47: use this script widely

open 'https://mail.google.com/mail/u/0/#inbox' 2>/dev/null & # TODO: UN-HARDCODE
firstlife-delegate  --limit-n-times-per-x 10 day $WITH_REWARD_ARG 'take care of a few emails' || accumulate_error 'ignored email'

exit_with_any_accumulated_errors
