#!/usr/bin/env bash

# Self, program thyself

# TODO: rename to something far sillier: "ask-self-to-do-stuff", I dunno.

# This came in handy when I went through a phase of wanting to do nothing but code. This program uses shellask to prompt
# me to do a tolerable mix of stuff. meant for running repeatedly.

. $SKIGGETY_UTILS_DIR/lib/skiggety-utils.bash

################################################################################
shellask 'do one act of self care or something on the habit tracker' || accumulate_error 'missed a habit'
shellask 'do another act of self care or something on the habit tracker' || accumulate_error 'missed a habit'

#### Today's Todo List #########################################################
# TODO: maybe something more like 5.times do today_todo; shellask work on your one of your top 3 todos and downvote it
# if appropriate:
today_todo --non-interactive
shellask 'run today_todo once or twice to make sure you are ready to focus on the right stuff' || \
    accumulate_error 'did not get tasks organized'
pushd ~/today_todo/
todos="$($SKIGGETY_UTILS_DIR/bin/todo|grep NOW|tail -n 3|tac)"
ORIGINAL_IFS="$IFS"
IFS=$'\n'
NEWLINE='
'
 read -rd '' -a todos_as_array <<<"$todos"
debug_here "echo \${todos_as_array} contains"
for todo_line in ${todos_as_array[@]};do
    shellask "Work on this task (and downvote or mark done using today_todo):${NEWLINE}${todo_line}" || \
        accumulate_error "Didn't work on todo: $todo_line"
done
IFS="$ORIGINAL_IFS"
popd

################################################################################

pushd $SKIGGETY_UTILS_DIR
shellask "commit some code" || accumulate_error "Did not commit"
popd

shellask "close a browser tab or 3 unless they are reasonable already" || accumulate_error "Did not clean up browser tabs"
clear

exit_if_any_accumulated_errors
