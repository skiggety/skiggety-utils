#!/usr/bin/env bash

# This script guides you through taking a short break, then calls your attention back

. $SKIGGETY_UTILS_DIR/lib/skiggety-utils.bash || exit 1
. $SKIGGETY_UTILS_DIR/lib/firstlife.bash || exit_with_error 'could not use common firstlife code'

DURATION_IN_SECONDS=300
while [[ "$1" == -* ]]; do

    # take '-t' flag so you can specify break duration in seconds, e.g: 'firstlife-break -t 60' between todo list tasks
    if [ "$1" == "-t" ]; then
        shift
        DURATION_IN_SECONDS="$1"
        shift
    fi
done

firstlife-status

shellask "Ready for a break? ($DURATION_IN_SECONDS seconds)" || exit 0

# TODO^14: mute here for DURATION_IN_SECONDS: firstlife-mute-behind-noise $DURATION_IN_SECONDS

sleep-verbose --with-countdown $DURATION_IN_SECONDS && firstlife-alarm "Your break is now over."
