#!/usr/bin/env bash
# TODO: consider #!/usr/bin/env python3 OR #!/usr/bin/env ruby

# This script provides a general purpose status report that is sensitive to the current directory. If you are in a git repo for a coding project, it'll give you an idea of h√∏w tests are doing, what's left to do/commit, etc. It will usuually be called from that directory's ./PWD_BIN/dashboard script to form the bulk of the output

THIS_DIR="$(cd "$(dirname $BASH_SOURCE)";pwd)"
. $THIS_DIR/../lib/skiggety-utils.bash || exit 1

# TODO TODO: highlight TODO's and ERRORS

echo_divider_with_text "-" "TODO's:"
$THIS_DIR/todo | tail -n 5 || exit_with_error "todo FAILED"

# TODO: only do this stuff if it's a git repository
# echo_divider_with_text "-" "git diff of unstaged files:"
# for next in $( git ls-files --others --exclude-standard ) ; do git -c color.ui=always --no-pager diff --no-index /dev/null $next; done | head -n 15  # git diff for files not checked in yet only?
echo_divider_with_text "-" "git diff:"
git -c color.ui=always --no-pager diff | head -n 15 # TODO: not sure if I should use head
echo_divider_with_text "-" "git status:"
git -c color.ui=always --no-pager status -ss | head -n 10 # TODO: not sure if I should use head
echo_divider_with_text "-" "un-pushed git commits:"
git log --pretty=oneline --abbrev-commit origin/master..HEAD
