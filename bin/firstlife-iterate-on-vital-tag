#!/usr/bin/env bash

# This script asks you to work on each todo list entry tracked by vital matching a certain tag.

# Usage: firstlife-iterate-on-vital-tag <tag> # where <tag> might be 'DAILY' or some such

. $SKIGGETY_UTILS_DIR/lib/skiggety-utils.bash || exit 1

tagged_todos="$(vital-list-by-tag "$1" | tac)"
ORIGINAL_IFS="$IFS"
IFS=$'\n'
read -rd '' -a tagged_todos_as_array <<<"$tagged_todos"
for todo_line in ${tagged_todos_as_array[@]};do
    firstlife-delegate --with-reward "Work on this task (and downvote or mark done using today_todo):${newline}${todo_line}" \
        || accumulate_error "Didn't work on todo: $todo_line"
done
IFS="$ORIGINAL_IFS"
