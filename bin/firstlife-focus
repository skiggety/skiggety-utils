#!/usr/bin/env bash

# This script (TODO...)

. $SKIGGETY_UTILS_DIR/lib/skiggety-utils.bash || exit 1
. $SKIGGETY_UTILS_DIR/lib/firstlife.bash || exit_with_error 'could not use common firstlife code'

# TODO^2?: exit if a script with identical name and path is in parent tree

exit_if_day_is_over # EASY to chip away at TODO^84: infect this and called scripts with this line all over the place to clean up windows (for ORGANIZATION)

################################################################################
# EASY TODO^86: normalize scripts with names like:
# - firstlife-focus
#   - firstlife-focus.routine.<username>
#   - firstlife-focus.routine.TEMPLATE

PERSONAL_ROUTINE_SCRIPT_NAME="$(personal_inner_routine_script_name $0)" # TODO^2: DELETE? (do I need this?)
PERSONAL_ROUTINE_SCRIPT="$(personal_inner_routine_script $0)" # TODO: DELETE? (do I need this?)

TEMPLATE_ROUTINE_SCRIPT_NAME="$(template_inner_routine_script_name $0)" # TODO^2: DELETE? (do I need this?)
TEMPLATE_ROUTINE_SCRIPT="$(template_inner_routine_script $0)" # TODO: DELETE? (do I need this?)

# NOW TODO^89: make the mechanism for using a custom script based on a template reusable -------- (it's good from here up) -----------------
# - NOW TODO^91: new migration plan. move existing scripts to be templates, use templates if custom script doesn't exist, and always offer to start or tweak a custom one at the end of the cycle so you're ready for next time.

# TODO: this should go in the inner script eventually:
today_todo -n | grep --color=always '\(POINT\|--------\|^$\)' # TODO^7: EXTRACT and REUSE this approach that includes the headings
firstlife-pomodoro 'most important stuff worth POINTS' || accumulate_error 'skipped pomodoro worth POINTS'

# EASY TODO^2: this should go in the inner script eventually:
today_todo -n | grep --color=always '\(POINT\|--------\|^$\)'
firstlife-pomodoro 'most important stuff worth POINTS (another one)' || accumulate_error 'skipped pomodoro worth POINTS'

exit_with_error "TODO^86: IMPLEMENT and use"

# TODO^2: (in template) try to mix in some work pomodoros until there are 16 on a weekday? maybe ask the user how many work pomodoros to do, with a default of 16, and then have you ask for a purpose for each
exit
