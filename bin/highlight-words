#!/usr/bin/env ruby

# pass every line of STDIN through a regex using colorhash-keyword before outputting it to STDOUT
# usage:
#     cat file | bin/highlight-words 'PATTERN'
#     cat file | bin/highlight-words 'PATTERN' 'ANOTHER_PATTERN' 'etc'

# TODO^341: consider alternate option, optionally: pattern="\\b(#{ARGV.join('|')})\\b" # words?
pattern="(#{ARGV.join('|')})" # strings?

if pattern == '()'
  STDERR.puts "Usage: cat file | bin/highlight-keywords 'PATTERN' 'ANOTHER_PATTERN' 'etc'"
  exit 1
end
# puts "DEBUG: Using pattern: #{pattern}"

$stdin.each_line do |line|
  puts line.gsub(/(#{pattern})/) { `colorhash-keyword #{$1}`.chomp }
end
