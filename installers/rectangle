#!/usr/bin/env ruby

# NOTE: using https://github.com/rxhanson/Rectangle because Spectacle is going to be unmaintained: https://github.com/eczarny/spectacle#important-note

require_relative '../lib/installable_skiggety_util.rb'

class RectangleInstaller

  include InstallableSkiggetyUtil

  def self.run # TODO TODO: EXTRACT to InstallableSkiggetyUtil
    self.new.run
  end

  def apparently_installed?
    if on_mac_os?
      return Dir.exist?("/Applications/Rectangle.app")
    else
      return true # rectangle not available for other OS'es, I think # TODO: but maybe install some equivalent
    end
  end

  def apparently_configured?
    return false # assume it needs configuration if there isn't a maker
  end

  def install
    if on_mac_os?
      # Using homebrew for the install, which means I need to install homebrew as a dependency, only if on a mac though.
      call_peer_installer('homebrew')

      system("brew cask install rectangle")
      raise "rectangle install failed" unless ($? == 0 )
    end
  end

  def configure
    if on_mac_os?
      if $interactive
        system("open /Applications/Rectangle.app")
        delegate_to_user "Configure #{name}"
      else
        raise_interactive_only_configuration
      end
    end
  end

end

RectangleInstaller.run
